<%# if @feast.photo.attached? %>
    <%#= cl_image_tag @feast.photo.key, height: 150, width: 75, crop: :fill %>
<%# end %>

<%# method for definig avatar is not yet available. %>

<%# if @feast.photo.attached? %>
    <%#= cl_image_tag @feast.photo.key, height: 150, width: 75, crop: :fill %>
<%# end %>

<p><%= @feast.title %></p>
</br>
<p><%= @feast.description %></p>
</br>
<p><%= @feast.meal_type %></p>
</br>
<p><%= @feast.price %></p>
</br>
<%# Method for defining distance to the party is not yet available. %>
<p><%= @feast.address %></p>
</br>

<p><%= @feast.start_at %></p>
</br>
<p><%= @feast.end_at %></p>
</br>
<%= @feast.available %>
        </br>
        </br>

<% if current_user.present? %>

    <% if current_user.host?(@feast) %>

        <% @reservations.each do |reservation| %>
            <%= reservation.user.first_name %>
            <%= reservation.user.last_name %>
            <%= reservation.comment %>
            <% if reservation.status == "pending" %>
                <%= button_to "Accept", accept_feast_reservation_path(reservation.feast, reservation), method: :put %>
                <%= button_to "Decline", decline_feast_reservation_path(reservation.feast, reservation), method: :put %>
                </br>
            <% else %>
                 <%= reservation.status %>
                </br>
            <% end %>
        <% end %>

    <% else %>

        <% if @reservation %>
            <strong><%= @reservation.status if !@reservation.nil? %></strong>

        <% else %>

            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#reservation-popup">
                Reserve
            </button>


        <% end %>
    

    <% end %>

<% else %>
        <%= button_to "Reserve", new_user_session_path(@user) %>
<% end %>

<div class="modal" tabindex="-1" role="dialog" id="reservation-popup">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Any questions for the host?</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <%= simple_form_for [@feast, Reservation.new] do |f| %>
                <div class="modal-body">
                    <%= f.input :comment %>
                    </div>
                    <div class="modal-footer">
                    <%= f.submit "Submit Reservation" %>
                    </div>
            <% end %>    
        </div>
    </div>
</div>

<%= @reservations.number_of_guests %>

    <div id="map"
        style="width: 100%; height: 400px;"
        data-markers="<%= @markers.to_json %>"
        data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
    </div>


